version: "3.8"

services:
  # üö™ API Gateway
  gateway:
    build: ./gateway
    container_name: gateway
    ports:
      - "8080:8080"
    depends_on:
      - user-service
      - subscription-service
      - battery-service
      - station-service
      - transaction-service
      - feedback-service
      - vehicle-service
    networks:
      - evnet

  # üë§ USER SERVICE
  user-service:
    build: ./user-service
    container_name: user-service
    depends_on:
      - mysql_user
    networks:
      - evnet

  mysql_user:
    image: mysql:8.0
    container_name: mysql_user
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: user_service
    networks:
      - evnet

  # üì¶ SUBSCRIPTION SERVICE
  subscription-service:
    build: ./subscription-service
    container_name: subscription-service
    depends_on:
      - mysql_subscription
    networks:
      - evnet

  mysql_subscription:
    image: mysql:8.0
    container_name: mysql_subscription
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: subscription_service
    networks:
      - evnet

  # üîã BATTERY SERVICE
  battery-service:
    build: ./battery-service
    container_name: battery-service
    depends_on:
      - mysql_battery
    networks:
      - evnet

  mysql_battery:
    image: mysql:8.0
    container_name: mysql_battery
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: battery_service
    networks:
      - evnet

  # üè≠ STATION SERVICE
  station-service:
    build: ./station-service
    container_name: station-service
    depends_on:
      - mysql_station
    networks:
      - evnet

  mysql_station:
    image: mysql:8.0
    container_name: mysql_station
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: station_service
    networks:
      - evnet

  # üí≥ TRANSACTION SERVICE
  transaction-service:
    build: ./transaction-service
    container_name: transaction-service
    depends_on:
      - mysql_transaction
    networks:
      - evnet

  mysql_transaction:
    image: mysql:8.0
    container_name: mysql_transaction
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: transaction_service
    networks:
      - evnet

  # üí¨ FEEDBACK SERVICE
  feedback-service:
    build: ./feedback-service
    container_name: feedback-service
    depends_on:
      - mysql_feedback
    networks:
      - evnet

  mysql_feedback:
    image: mysql:8.0
    container_name: mysql_feedback
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: feedback_service
    networks:
      - evnet

  # üöó VEHICLE SERVICE
  vehicle-service:
    build: ./vehicle-service
    container_name: vehicle-service
    depends_on:
      - mysql_vehicle
    networks:
      - evnet

  mysql_vehicle:
    image: mysql:8.0
    container_name: mysql_vehicle
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: vehicle_service
    networks:
      - evnet

# üåê Shared Network
networks:
  evnet:
    driver: bridge
